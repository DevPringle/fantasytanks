<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NA 15v15 Summer Series - WoT Fantasy</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons&display=swap" rel="stylesheet">
    <style>
        .material-icons {
            font-family: 'Material Icons', 'Material Icons Outlined', sans-serif;
            font-weight: normal;
            font-style: normal;
            font-size: 24px;
            line-height: 1;
            letter-spacing: normal;
            text-transform: none;
            display: inline-block;
            white-space: nowrap;
            word-wrap: normal;
            direction: ltr;
            -webkit-font-feature-settings: 'liga';
            -webkit-font-smoothing: antialiased;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background: linear-gradient(135deg, #0f1419 0%, #1a2332 100%);
            color: #ffffff;
            min-height: 100vh;
            line-height: 1.6;
            overflow-x: hidden;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 20px;
        }

        /* Header */
        .header {
            background: rgba(15, 20, 25, 0.95);
            backdrop-filter: blur(20px);
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            position: sticky;
            top: 0;
            z-index: 1000;
            transition: all 0.3s ease;
        }

        .nav {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1rem 0;
        }

        .logo {
            text-decoration: none;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
        }

        .logo img {
            height: 36px;
            width: auto;
            max-width: 220px;
            transition: all 0.3s ease;
            filter: drop-shadow(0 0 20px rgba(0, 212, 255, 0.3));
        }

        .logo:hover img {
            transform: scale(1.05);
            filter: drop-shadow(0 0 30px rgba(0, 212, 255, 0.5));
        }

        .nav-menu {
            display: flex;
            gap: 2.5rem;
            list-style: none;
        }

        .nav-link {
            color: #ffffff;
            text-decoration: none;
            font-weight: 500;
            transition: all 0.3s ease;
            position: relative;
            padding: 0.5rem 0;
        }

        .nav-link:hover {
            color: #00d4ff;
            transform: translateY(-2px);
        }

        .nav-link::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            width: 0;
            height: 2px;
            background: linear-gradient(135deg, #00d4ff, #00b8e6);
            transition: width 0.3s ease;
            border-radius: 2px;
        }

        .nav-link:hover::after {
            width: 100%;
        }

        .auth-section {
            display: flex;
            gap: 1rem;
            align-items: center;
        }

        .user-menu {
            position: relative;
        }

        .user-btn {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            color: white;
            padding: 0.6rem 1rem;
            border-radius: 10px;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.3s ease;
        }

        .user-btn:hover {
            background: rgba(255, 255, 255, 0.15);
            border-color: rgba(0, 212, 255, 0.5);
        }

        .user-dropdown {
            position: absolute;
            top: 100%;
            right: 0;
            margin-top: 0.5rem;
            background: rgba(15, 20, 25, 0.95);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            padding: 0.5rem;
            min-width: 200px;
            backdrop-filter: blur(20px);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
            display: none;
            z-index: 1000;
        }

        .user-dropdown.show {
            display: block;
            animation: fadeInDown 0.3s ease;
        }

        @keyframes fadeInDown {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .dropdown-item {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            padding: 0.75rem 1rem;
            color: rgba(255, 255, 255, 0.8);
            text-decoration: none;
            border-radius: 8px;
            transition: all 0.3s ease;
            font-size: 0.9rem;
            cursor: pointer;
            border: none;
            background: none;
            width: 100%;
            text-align: left;
        }

        .dropdown-item:hover {
            background: rgba(255, 255, 255, 0.1);
            color: #ffffff;
        }

        .dropdown-divider {
            height: 1px;
            background: rgba(255, 255, 255, 0.1);
            margin: 0.5rem 0;
        }

        .sign-in-btn {
            padding: 0.8rem 2rem;
            background: linear-gradient(135deg, #00d4ff, #00b8e6);
            border: none;
            color: white;
            border-radius: 12px;
            cursor: pointer;
            font-weight: 600;
            font-size: 0.95rem;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(0, 212, 255, 0.2);
        }

        .sign-in-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 30px rgba(0, 212, 255, 0.4);
            background: linear-gradient(135deg, #00b8e6, #00d4ff);
        }

        .mobile-toggle {
            display: none;
            background: transparent;
            border: none;
            color: white;
            font-size: 1.5rem;
            cursor: pointer;
            padding: 0.5rem;
            border-radius: 8px;
            transition: all 0.3s ease;
        }

        /* Tournament Header */
        .tournament-header {
            background: 
                radial-gradient(circle at 30% 20%, rgba(0, 212, 255, 0.15), transparent 50%),
                radial-gradient(circle at 70% 80%, rgba(0, 184, 230, 0.1), transparent 50%),
                linear-gradient(135deg, rgba(0, 212, 255, 0.05), rgba(26, 35, 50, 0.2));
            padding: 3rem 0 2rem;
            position: relative;
            overflow: hidden;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .tournament-header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><defs><pattern id="grid" width="10" height="10" patternUnits="userSpaceOnUse"><path d="M 10 0 L 0 0 0 10" fill="none" stroke="rgba(255,255,255,0.03)" stroke-width="0.5"/></pattern></defs><rect width="100" height="100" fill="url(%23grid)"/></svg>');
            opacity: 0.5;
        }

        .tournament-header-content {
            position: relative;
            z-index: 2;
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            gap: 2rem;
            flex-wrap: wrap;
        }

        .tournament-info {
            flex: 1;
            min-width: 300px;
        }

        .tournament-breadcrumb {
            color: rgba(255, 255, 255, 0.6);
            font-size: 0.9rem;
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .tournament-breadcrumb a {
            color: #00d4ff;
            text-decoration: none;
            transition: all 0.3s ease;
        }

        .tournament-breadcrumb a:hover {
            color: #ffffff;
        }

        .tournament-name {
            font-size: 3rem;
            font-weight: 800;
            margin-bottom: 1rem;
            background: linear-gradient(135deg, #00d4ff 0%, #00b8e6 50%, #0099cc 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            line-height: 1.2;
        }

        .tournament-meta {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }

        .meta-item {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            color: rgba(255, 255, 255, 0.8);
            font-size: 0.95rem;
        }

        .meta-icon {
            color: #00d4ff;
            font-size: 1.2rem;
        }

        .tournament-status-header {
            display: flex;
            align-items: center;
            gap: 1rem;
            flex-wrap: wrap;
            margin-bottom: 1rem;
        }

        .status-badge {
            padding: 0.6rem 1.2rem;
            border-radius: 25px;
            font-size: 0.9rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            background: rgba(34, 197, 94, 0.2);
            color: #22c55e;
            border: 1px solid rgba(34, 197, 94, 0.4);
            box-shadow: 0 0 15px rgba(34, 197, 94, 0.2);
            transition: all 0.3s ease;
        }

        .status-badge.locked {
            background: rgba(239, 68, 68, 0.2);
            color: #ef4444;
            border-color: rgba(239, 68, 68, 0.4);
            box-shadow: 0 0 15px rgba(239, 68, 68, 0.2);
        }

        .fantasy-info {
            text-align: right;
        }

        .fantasy-stat {
            font-size: 2rem;
            font-weight: 800;
            color: #00d4ff;
            margin-bottom: 0.5rem;
        }

        .fantasy-label {
            color: rgba(255, 255, 255, 0.6);
            font-size: 0.9rem;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .roster-actions {
            display: flex;
            gap: 1rem;
            margin-top: 1rem;
        }

        .action-btn {
            padding: 0.8rem 1.5rem;
            background: linear-gradient(135deg, #00d4ff, #00b8e6);
            border: none;
            color: white;
            border-radius: 10px;
            cursor: pointer;
            font-weight: 600;
            font-size: 0.95rem;
            transition: all 0.3s ease;
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            box-shadow: 0 4px 15px rgba(0, 212, 255, 0.2);
        }

        .action-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0, 212, 255, 0.3);
        }

        .action-btn.secondary {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            box-shadow: none;
        }

        .action-btn.secondary:hover {
            background: rgba(255, 255, 255, 0.15);
            border-color: rgba(0, 212, 255, 0.5);
        }

        /* Tournament Navigation */
        .tournament-nav {
            background: rgba(255, 255, 255, 0.03);
            backdrop-filter: blur(10px);
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            position: sticky;
            top: 80px;
            z-index: 999;
        }

        .tournament-nav-container {
            display: flex;
            justify-content: center;
            overflow-x: auto;
            scrollbar-width: none;
            -ms-overflow-style: none;
        }

        .tournament-nav-container::-webkit-scrollbar {
            display: none;
        }

        .nav-tabs {
            display: flex;
            gap: 0;
            list-style: none;
            min-width: max-content;
        }

        .nav-tab {
            padding: 1.2rem 2rem;
            background: transparent;
            border: none;
            color: rgba(255, 255, 255, 0.7);
            font-weight: 500;
            font-size: 0.95rem;
            cursor: pointer;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            border-bottom: 3px solid transparent;
            position: relative;
            text-decoration: none;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .nav-tab:hover {
            color: #ffffff;
            background: rgba(255, 255, 255, 0.05);
        }

        .nav-tab.active {
            color: #00d4ff;
            border-bottom-color: #00d4ff;
            background: rgba(0, 212, 255, 0.05);
        }

        /* Main Content Area */
        .tournament-content {
            padding: 3rem 0;
            min-height: 60vh;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
            animation: fadeIn 0.5s ease-in-out;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Loading State */
        .loading-state {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 4rem 2rem;
            color: rgba(255, 255, 255, 0.6);
        }

        .loading-spinner {
            width: 40px;
            height: 40px;
            border: 3px solid rgba(0, 212, 255, 0.2);
            border-top: 3px solid #00d4ff;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-bottom: 1rem;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Error State */
        .error-state {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 4rem 2rem;
            color: rgba(239, 68, 68, 0.8);
            text-align: center;
        }

        .error-icon {
            font-size: 4rem;
            margin-bottom: 1rem;
            opacity: 0.6;
        }

        .retry-btn {
            margin-top: 1rem;
            padding: 0.8rem 1.5rem;
            background: rgba(239, 68, 68, 0.2);
            border: 1px solid rgba(239, 68, 68, 0.4);
            color: #ef4444;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .retry-btn:hover {
            background: rgba(239, 68, 68, 0.3);
        }

        /* Overview Tab */
        .overview-grid {
            display: grid;
            grid-template-columns: 2fr 1fr;
            gap: 3rem;
            margin-bottom: 3rem;
        }

        .overview-main {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 16px;
            padding: 2.5rem;
            backdrop-filter: blur(10px);
        }

        .overview-sidebar {
            display: flex;
            flex-direction: column;
            gap: 2rem;
        }

        .sidebar-card {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 16px;
            padding: 2rem;
            backdrop-filter: blur(10px);
        }

        .section-title {
            font-size: 1.8rem;
            font-weight: 700;
            color: #ffffff;
            margin-bottom: 1.5rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .section-subtitle {
            font-size: 1.2rem;
            font-weight: 600;
            color: #ffffff;
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .tournament-description {
            color: rgba(255, 255, 255, 0.8);
            line-height: 1.7;
            margin-bottom: 2rem;
            font-size: 1rem;
        }

        .progress-section {
            margin-bottom: 2rem;
        }

        .progress-label {
            display: flex;
            justify-content: space-between;
            margin-bottom: 0.5rem;
            font-size: 0.9rem;
            color: rgba(255, 255, 255, 0.7);
        }

        .progress-bar {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            height: 8px;
            overflow: hidden;
            margin-bottom: 1rem;
        }

        .progress-fill {
            background: linear-gradient(135deg, #00d4ff, #00b8e6);
            height: 100%;
            border-radius: 10px;
            transition: width 0.3s ease;
        }

        .quick-stats {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 1rem;
        }

        .quick-stat {
            text-align: center;
            padding: 1rem;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 8px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .quick-stat-number {
            font-size: 1.5rem;
            font-weight: 700;
            color: #00d4ff;
            display: block;
            margin-bottom: 0.5rem;
        }

        .quick-stat-label {
            color: rgba(255, 255, 255, 0.7);
            font-size: 0.8rem;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        /* Top Teams List */
        .teams-list {
            list-style: none;
        }

        .team-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1rem;
            margin-bottom: 0.5rem;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 8px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            transition: all 0.3s ease;
        }

        .team-item:hover {
            background: rgba(255, 255, 255, 0.08);
            border-color: rgba(0, 212, 255, 0.3);
        }

        .team-info {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .team-rank {
            font-weight: 700;
            color: #00d4ff;
            min-width: 2rem;
        }

        .team-name {
            font-weight: 600;
            color: #ffffff;
        }

        .team-score {
            font-weight: 600;
            color: #00d4ff;
        }

        /* Recent Activity */
        .activity-list {
            list-style: none;
        }

        .activity-item {
            display: flex;
            align-items: center;
            gap: 1rem;
            padding: 1rem 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .activity-item:last-child {
            border-bottom: none;
        }

        .activity-icon {
            color: #00d4ff;
            font-size: 1.2rem;
        }

        .activity-content {
            flex: 1;
        }

        .activity-text {
            color: rgba(255, 255, 255, 0.9);
            font-size: 0.9rem;
            margin-bottom: 0.2rem;
        }

        .activity-time {
            color: rgba(255, 255, 255, 0.5);
            font-size: 0.8rem;
        }

        /* Players Tab Styles */
        .players-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 2rem;
            flex-wrap: wrap;
            gap: 1rem;
        }

        .players-filters {
            display: flex;
            align-items: center;
            gap: 2rem;
        }

        .filter-group {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .filter-group label {
            color: rgba(255, 255, 255, 0.8);
            font-size: 0.9rem;
            font-weight: 500;
        }

        .filter-select {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            color: #ffffff;
            padding: 0.5rem 1rem;
            border-radius: 8px;
            font-size: 0.9rem;
            min-width: 120px;
        }

        .filter-select option {
            background: #1a2332;
            color: #ffffff;
        }

        .show-label {
            color: rgba(255, 255, 255, 0.6);
            font-size: 0.9rem;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .players-table-container {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 16px;
            overflow: hidden;
            backdrop-filter: blur(10px);
            margin-bottom: 2rem;
        }

        .players-table {
            width: 100%;
            border-collapse: collapse;
        }

        .players-table th {
            background: rgba(255, 255, 255, 0.08);
            padding: 1rem;
            text-align: left;
            color: rgba(255, 255, 255, 0.9);
            font-weight: 600;
            font-size: 0.9rem;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            position: relative;
        }

        .players-table th.sortable {
            cursor: pointer;
            transition: all 0.3s ease;
            user-select: none;
        }

        .players-table th.sortable:hover {
            background: rgba(255, 255, 255, 0.12);
            color: #00d4ff;
        }

        .players-table th.action-column {
            width: 80px;
            text-align: center;
        }

        .sort-icon {
            position: absolute;
            right: 0.5rem;
            top: 50%;
            transform: translateY(-50%);
            font-size: 1rem;
            opacity: 0.5;
            transition: all 0.3s ease;
        }

        .players-table th.sortable.asc .sort-icon {
            transform: translateY(-50%) rotate(180deg);
            opacity: 1;
            color: #00d4ff;
        }

        .players-table th.sortable.desc .sort-icon {
            opacity: 1;
            color: #00d4ff;
        }

        .players-table td {
            padding: 1rem;
            border-bottom: 1px solid rgba(255, 255, 255, 0.05);
            color: rgba(255, 255, 255, 0.9);
            font-size: 0.95rem;
        }

        .players-table tr:hover {
            background: rgba(255, 255, 255, 0.05);
        }

        .player-action-btn {
            background: transparent;
            border: 1px solid rgba(255, 255, 255, 0.3);
            color: rgba(255, 255, 255, 0.7);
            padding: 0.5rem;
            border-radius: 6px;
            cursor: not-allowed;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            width: 36px;
            height: 36px;
        }

        .player-action-btn.add {
            border-color: rgba(34, 197, 94, 0.5);
            color: #22c55e;
            cursor: pointer;
        }

        .player-action-btn.add:hover {
            background: rgba(34, 197, 94, 0.2);
            border-color: #22c55e;
            transform: scale(1.05);
        }

        .player-action-btn.remove {
            border-color: rgba(239, 68, 68, 0.5);
            color: #ef4444;
            cursor: pointer;
        }

        .player-action-btn.remove:hover {
            background: rgba(239, 68, 68, 0.2);
            border-color: #ef4444;
            transform: scale(1.05);
        }

        .player-name {
            font-weight: 600;
            color: #ffffff;
        }

        .player-team {
            font-weight: 600;
            color: #00d4ff;
        }

        .player-battles {
            color: rgba(255, 255, 255, 0.8);
        }

        .player-points {
            font-weight: 600;
            color: #00d4ff;
        }

        .player-avg {
            color: rgba(255, 255, 255, 0.8);
        }

        .player-picked {
            color: rgba(255, 255, 255, 0.7);
        }

        .roster-sidebar {
            position: fixed;
            right: 2rem;
            top: 50%;
            transform: translateY(-50%);
            width: 300px;
            z-index: 1000;
        }

        .roster-card {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 16px;
            padding: 1.5rem;
            backdrop-filter: blur(10px);
        }

        .roster-title {
            font-size: 1.2rem;
            font-weight: 700;
            color: #ffffff;
            margin-bottom: 1rem;
            text-align: center;
        }

        .roster-status {
            text-align: center;
            color: #00d4ff;
            font-weight: 600;
            margin-bottom: 1rem;
            font-size: 1.1rem;
        }

        .roster-message {
            color: rgba(255, 255, 255, 0.7);
            font-size: 0.9rem;
            line-height: 1.5;
            text-align: center;
            padding: 1rem;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 8px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .roster-list {
            display: none;
        }

        .roster-player {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0.75rem;
            margin-bottom: 0.5rem;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 8px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .roster-player-name {
            color: #ffffff;
            font-weight: 500;
        }

        .roster-player-remove {
            background: transparent;
            border: none;
            color: #ef4444;
            cursor: pointer;
            padding: 0.25rem;
            border-radius: 4px;
            transition: all 0.3s ease;
        }

        .roster-player-remove:hover {
            background: rgba(239, 68, 68, 0.2);
        }

        /* Footer */
        .footer {
            background: rgba(15, 20, 25, 0.9);
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            padding: 3rem 0 2rem;
            margin-top: 5rem;
            backdrop-filter: blur(20px);
        }

        .footer-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 2rem;
        }

        .footer-links {
            display: flex;
            gap: 2.5rem;
            list-style: none;
        }

        .footer-links a {
            color: rgba(255, 255, 255, 0.7);
            text-decoration: none;
            transition: all 0.3s ease;
            font-weight: 500;
        }

        .footer-links a:hover {
            color: #00d4ff;
            transform: translateY(-2px);
        }

        .footer-note {
            color: rgba(255, 255, 255, 0.5);
            font-size: 0.9rem;
            text-align: center;
            max-width: 400px;
        }

        /* Focus states for accessibility */
        .action-btn:focus,
        .nav-tab:focus,
        .region-btn:focus,
        .player-action-btn:focus {
            outline: 2px solid #00d4ff;
            outline-offset: 2px;
        }

        /* Responsive Design */
        @media (max-width: 1200px) {
            .roster-sidebar {
                position: static;
                transform: none;
                width: 100%;
                margin-top: 2rem;
            }
        }

        @media (max-width: 768px) {
            .nav-menu {
                display: none;
                position: absolute;
                top: 100%;
                left: 0;
                right: 0;
                background: rgba(15, 20, 25, 0.98);
                flex-direction: column;
                padding: 2rem;
                border-top: 1px solid rgba(255, 255, 255, 0.1);
            }

            .nav-menu.active {
                display: flex;
            }

            .mobile-toggle {
                display: block;
            }

            .tournament-name {
                font-size: 2rem;
            }

            .tournament-header-content {
                flex-direction: column;
                align-items: stretch;
            }

            .overview-grid {
                grid-template-columns: 1fr;
                gap: 2rem;
            }

            .tournament-meta {
                grid-template-columns: 1fr;
                gap: 1rem;
            }

            .nav-tabs {
                flex-wrap: wrap;
                justify-content: center;
            }

            .nav-tab {
                padding: 1rem 1.5rem;
                font-size: 0.9rem;
            }

            .quick-stats {
                grid-template-columns: 1fr;
            }

            .roster-actions {
                flex-direction: column;
            }

            .players-header {
                flex-direction: column;
                align-items: stretch;
            }

            .players-filters {
                justify-content: space-between;
            }

            .players-table-container {
                overflow-x: auto;
            }

            .players-table {
                min-width: 600px;
            }

            .players-table th,
            .players-table td {
                padding: 0.75rem 0.5rem;
                font-size: 0.85rem;
            }
        }

        @keyframes slideInRight {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }
    </style>
</head>
<body>
    <!-- Load API first -->
    <script src="api.js"></script>
    
    <header class="header" id="header">
        <nav class="nav container">
            <a href="index.html" class="logo">
                <img src="images/WotFan200x36.png" alt="Fantasy Tanks Logo">
            </a>
            
            <ul class="nav-menu" id="navMenu">
                <li><a href="tournaments.html" class="nav-link">Tournaments</a></li>
                <li><a href="index.html#groups" class="nav-link">Groups</a></li>
                <li><a href="index.html#guide" class="nav-link">Guide</a></li>
                <li><a href="index.html#contact" class="nav-link">Contact</a></li>
            </ul>

            <div class="auth-section">
                <div class="user-menu" id="userMenu" style="display: none;">
                    <button class="user-btn" onclick="toggleUserDropdown()">
                        <span class="material-icons">person</span>
                        <span id="username"></span>
                        <span class="material-icons">expand_more</span>
                    </button>
                    <div class="user-dropdown" id="userDropdown">
                        <a href="#profile" class="dropdown-item">
                            <span class="material-icons">person</span>
                            Profile
                        </a>
                        <a href="#settings" class="dropdown-item">
                            <span class="material-icons">settings</span>
                            Settings
                        </a>
                        <div class="dropdown-divider"></div>
                        <button class="dropdown-item" onclick="handleLogout()">
                            <span class="material-icons">logout</span>
                            Sign Out
                        </button>
                    </div>
                </div>
                <button class="sign-in-btn" id="signInBtn" aria-label="Sign in to your account" onclick="redirectToLogin()">Sign In</button>
                <button class="mobile-toggle" id="mobileToggle" aria-label="Toggle mobile menu">
                    <span class="material-icons">menu</span>
                </button>
            </div>
        </nav>
    </header>

    <main>
        <!-- Tournament Header -->
        <section class="tournament-header">
            <div class="container">
                <div class="tournament-header-content">
                    <div class="tournament-info">
                        <div class="tournament-breadcrumb">
                            <a href="tournaments.html">Tournaments</a>
                            <span class="material-icons" style="font-size: 1rem;">chevron_right</span>
                            <span>NA 15v15 Summer Series</span>
                        </div>
                        
                        <h1 class="tournament-name">NA 15v15 Summer Series</h1>
                        
                        <div class="tournament-meta">
                            <div class="meta-item">
                                <span class="material-icons meta-icon">public</span>
                                <span>North America</span>
                            </div>
                            <div class="meta-item">
                                <span class="material-icons meta-icon">groups</span>
                                <span>Pick 10 Players</span>
                            </div>
                            <div class="meta-item">
                                <span class="material-icons meta-icon">schedule</span>
                                <span id="timeLeft">22d 14h left</span>
                            </div>
                            <div class="meta-item">
                                <span class="material-icons meta-icon">sports_esports</span>
                                <span id="fantasyTeamCount">Loading...</span>
                            </div>
                        </div>

                        <div class="tournament-status-header">
                            <span class="status-badge" id="rosterStatus">Loading...</span>
                        </div>

                        <div class="roster-actions">
                            <button class="action-btn" onclick="goToPlayersTab()">
                                <span class="material-icons">sports_esports</span>
                                Set My Roster
                            </button>
                            <button class="action-btn secondary" onclick="goToStandingsTab()">
                                <span class="material-icons">leaderboard</span>
                                View Leaderboard
                            </button>
                        </div>
                    </div>

                    <div class="fantasy-info">
                        <div class="fantasy-label">Fantasy Teams Competing</div>
                        <div class="fantasy-stat" id="fantasyTeamCountLarge">Loading...</div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Tournament Navigation -->
        <nav class="tournament-nav">
            <div class="container">
                <div class="tournament-nav-container">
                    <ul class="nav-tabs">
                        <li><a href="#overview" class="nav-tab active" data-tab="overview">
                            <span class="material-icons" style="font-size: 1rem;">home</span>
                            Overview
                        </a></li>
                        <li><a href="#schedule" class="nav-tab" data-tab="schedule">
                            <span class="material-icons" style="font-size: 1rem;">schedule</span>
                            Schedule
                        </a></li>
                        <li><a href="#standings" class="nav-tab" data-tab="standings">
                            <span class="material-icons" style="font-size: 1rem;">leaderboard</span>
                            Standings
                        </a></li>
                        <li><a href="#players" class="nav-tab" data-tab="players">
                            <span class="material-icons" style="font-size: 1rem;">people</span>
                            Players
                        </a></li>
                        <li><a href="#teams" class="nav-tab" data-tab="teams">
                            <span class="material-icons" style="font-size: 1rem;">groups</span>
                            Teams
                        </a></li>
                        <li><a href="#stats" class="nav-tab" data-tab="stats">
                            <span class="material-icons" style="font-size: 1rem;">analytics</span>
                            Stats
                        </a></li>
                    </ul>
                </div>
            </div>
        </nav>

        <!-- Tournament Content -->
        <section class="tournament-content container">
            <!-- Overview Tab -->
            <div id="overview" class="tab-content active">
                <div class="overview-grid">
                    <div class="overview-main">
                        <h2 class="section-title">
                            <span class="material-icons">info</span>
                            Tournament Information
                        </h2>
                        <p class="tournament-description">
                            Welcome to the fantasy tournament based on the NA 15v15 Summer Series professional league. Draft your ultimate fantasy lineup from the players competing and earn points based on their performance.
                        </p>
                        <p class="tournament-description">
                            Fantasy points are awarded based on real-time performance metrics including kills, damage dealt, objectives captured, and overall team performance. Build your roster of 10 players strategically to maximize your fantasy points and climb the leaderboard against other fantasy teams.
                        </p>

                        <div class="progress-section">
                            <h3 class="section-subtitle">
                                <span class="material-icons">timeline</span>
                                Tournament Progress
                            </h3>
                            <div class="progress-label">
                                <span>Tournament Phase: Group Stage</span>
                                <span>25%</span>
                            </div>
                            <div class="progress-bar">
                                <div class="progress-fill" style="width: 25%;"></div>
                            </div>
                            <p style="color: rgba(255, 255, 255, 0.7); font-size: 0.9rem; margin-top: 0.5rem;">
                                Teams are currently competing in the group stage. 
                            </p>
                        </div>

                        <div class="quick-stats">
                            <div class="quick-stat">
                                <span class="quick-stat-number">7</span>
                                <span class="quick-stat-label">Match Days</span>
                            </div>
                            <div class="quick-stat">
                                <span class="quick-stat-number" id="totalPlayers">Loading...</span>
                                <span class="quick-stat-label">Available Players</span>
                            </div>
                            <div class="quick-stat">
                                <span class="quick-stat-number" id="totalFantasyTeams">Loading...</span>
                                <span class="quick-stat-label">Fantasy Teams</span>
                            </div>
                            <div class="quick-stat">
                                <span class="quick-stat-number">4</span>
                                <span class="quick-stat-label">Weeks Duration</span>
                            </div>
                        </div>
                    </div>

                    <div class="overview-sidebar">
                        <div class="sidebar-card">
                            <h3 class="section-subtitle">
                                <span class="material-icons">emoji_events</span>
                                Top Fantasy Teams
                            </h3>
                            <div id="topTeamsContainer">
                                <div class="loading-state">
                                    <div class="loading-spinner"></div>
                                    <p>Loading leaderboard...</p>
                                </div>
                            </div>
                        </div>

                        <div class="sidebar-card">
                            <h3 class="section-subtitle">
                                <span class="material-icons">notifications</span>
                                Recent Activity
                            </h3>
                            <ul class="activity-list">
                                <li class="activity-item">
                                    <span class="material-icons activity-icon">person_add</span>
                                    <div class="activity-content">
                                        <div class="activity-text">Fantasy teams are actively building rosters</div>
                                        <div class="activity-time">Live updates</div>
                                    </div>
                                </li>
                                <li class="activity-item">
                                    <span class="material-icons activity-icon">swap_horiz</span>
                                    <div class="activity-content">
                                        <div class="activity-text">Players being drafted across all fantasy teams</div>
                                        <div class="activity-time">Real-time</div>
                                    </div>
                                </li>
                                <li class="activity-item">
                                    <span class="material-icons activity-icon">star</span>
                                    <div class="activity-content">
                                        <div class="activity-text">Fantasy scoring based on tournament performance</div>
                                        <div class="activity-time">Live scoring</div>
                                    </div>
                                </li>
                                <li class="activity-item">
                                    <span class="material-icons activity-icon">schedule</span>
                                    <div class="activity-content">
                                        <div class="activity-text">Tournament matches updating fantasy points</div>
                                        <div class="activity-time">Continuous</div>
                                    </div>
                                </li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Schedule Tab -->
            <div id="schedule" class="tab-content">
                <h2 class="section-title">
                    <span class="material-icons">schedule</span>
                    Pro Tournament Schedule
                </h2>
                <div style="text-align: center; padding: 4rem 2rem; color: rgba(255, 255, 255, 0.6);">
                    <span class="material-icons" style="font-size: 4rem; margin-bottom: 1rem; opacity: 0.4;">schedule</span>
                    <h3 style="margin-bottom: 1rem;">Pro Match Schedule Coming Soon</h3>
                    <p>Pro tournament match schedules will be available here to help you track when your fantasy players compete.</p>
                </div>
            </div>

            <!-- Standings Tab -->
            <div id="standings" class="tab-content">
                <h2 class="section-title">
                    <span class="material-icons">leaderboard</span>
                    Fantasy Leaderboard
                </h2>
                <div id="standingsContainer">
                    <div class="loading-state">
                        <div class="loading-spinner"></div>
                        <p>Loading fantasy leaderboard...</p>
                    </div>
                </div>
            </div>

            <!-- Players Tab -->
            <div id="players" class="tab-content">
                <div class="players-header">
                    <h2 class="section-title">
                        <span class="material-icons">people</span>
                        Fantasy Player Pool
                    </h2>
                    <div class="players-filters">
                        <div class="filter-group">
                            <label for="teamFilter">Team:</label>
                            <select id="teamFilter" class="filter-select">
                                <option value="">All Teams</option>
                            </select>
                        </div>
                        <div class="filter-group">
                            <span class="show-label">SHOW</span>
                        </div>
                    </div>
                </div>

                <div id="playersContainer">
                    <div class="loading-state">
                        <div class="loading-spinner"></div>
                        <p>Loading player data...</p>
                    </div>
                </div>

                <div class="roster-sidebar">
                    <div class="roster-card">
                        <h3 class="roster-title">Your Fantasy Roster</h3>
                        <div class="roster-status">
                            <span id="rosterCount">0</span>/10 Players Selected
                        </div>
                        <div class="roster-message" id="rosterMessage">
                            Your roster is empty. Add players from the table above to build your fantasy team.
                        </div>
                        <div class="roster-list" id="rosterList">
                            <!-- Selected players will appear here -->
                        </div>
                    </div>
                </div>
            </div>

            <!-- Teams Tab -->
            <div id="teams" class="tab-content">
                <h2 class="section-title">
                    <span class="material-icons">groups</span>
                    Pro Team Rosters
                </h2>
                <div id="teamsContainer">
                    <div class="loading-state">
                        <div class="loading-spinner"></div>
                        <p>Loading team data...</p>
                    </div>
                </div>
            </div>

            <!-- Stats Tab -->
            <div id="stats" class="tab-content">
                <h2 class="section-title">
                    <span class="material-icons">analytics</span>
                    Fantasy Statistics
                </h2>
                <div style="text-align: center; padding: 4rem 2rem; color: rgba(255, 255, 255, 0.6);">
                    <span class="material-icons" style="font-size: 4rem; margin-bottom: 1rem; opacity: 0.4;">analytics</span>
                    <h3 style="margin-bottom: 1rem;">Fantasy Stats Coming Soon</h3>
                    <p>Detailed fantasy performance analytics, player trends, and optimal drafting insights will be available during the tournament.</p>
                </div>
            </div>
        </section>
    </main>

    <footer class="footer">
        <div class="container">
            <div class="footer-content">
                <ul class="footer-links">
                    <li><a href="#resources">Resources</a></li>
                    <li><a href="#terms">Terms of Service</a></li>
                    <li><a href="#contact">Contact</a></li>
                    <li><a href="#privacy">Privacy Policy</a></li>
                </ul>
                <div class="footer-note">
                    <p>Original concept by Hypnotik • Created by pringle</p>
                    <p>This website is not affiliated with Wargaming.net or World of Tanks</p>
                </div>
            </div>
        </div>
    </footer>

    <script>
        // Global variables
        let tournamentId = 'na-15v15-summer-series';
        let currentRoster = [];
        let maxRosterSize = 10;
        let rostersUnlocked = true;
        let players = [];
        let teams = [];
        let leaderboard = [];

        // Initialize the page
        async function initializePage() {
            console.log('🚀 Initializing tournament page...');
            
            // Check authentication and update UI
            updateAuthUI();
            
            // Load tournament data
            await loadTournamentData();
            
            // Load user's existing roster if authenticated
            if (api.isAuthenticated()) {
                await loadUserRoster();
            }
            
            console.log('✅ Tournament page initialized successfully');
        }

        // Update authentication UI
        function updateAuthUI() {
            const userMenu = document.getElementById('userMenu');
            const signInBtn = document.getElementById('signInBtn');
            const usernameSpan = document.getElementById('username');
            
            if (api.isAuthenticated()) {
                const user = api.getCurrentUser();
                if (user && userMenu && signInBtn && usernameSpan) {
                    userMenu.style.display = 'block';
                    signInBtn.style.display = 'none';
                    usernameSpan.textContent = user.username;
                }
                
                // Update roster status message for authenticated users
                updateRosterStatusForAuth();
            } else {
                if (userMenu && signInBtn) {
                    userMenu.style.display = 'none';
                    signInBtn.style.display = 'block';
                }
                
                // Update roster message for non-authenticated users
                updateRosterMessageForGuests();
            }
        }

        // Load all tournament data
        async function loadTournamentData() {
            try {
                console.log('📊 Loading tournament data...');
                
                // Load players, teams, and leaderboard in parallel
                const [playersResult, teamsResult, leaderboardResult] = await Promise.allSettled([
                    loadPlayers(),
                    loadTeams(),
                    loadLeaderboard()
                ]);
                
                // Handle results
                if (playersResult.status === 'fulfilled') {
                    console.log('✅ Players loaded:', playersResult.value?.length || 0);
                } else {
                    console.error('❌ Failed to load players:', playersResult.reason);
                }
                
                if (teamsResult.status === 'fulfilled') {
                    console.log('✅ Teams loaded:', teamsResult.value?.length || 0);
                } else {
                    console.error('❌ Failed to load teams:', teamsResult.reason);
                }
                
                if (leaderboardResult.status === 'fulfilled') {
                    console.log('✅ Leaderboard loaded:', leaderboardResult.value?.length || 0);
                } else {
                    console.error('❌ Failed to load leaderboard:', leaderboardResult.reason);
                }
                
                // Update UI with loaded data
                updateTournamentStats();
                
            } catch (error) {
                console.error('❌ Error loading tournament data:', error);
            }
        }

        // Load players from API
        async function loadPlayers() {
            try {
                const response = await api.getPlayers(tournamentId);
                players = response.players || [];
                
                if (players.length === 0) {
                    console.warn('⚠️ No players found from API, using fallback data');
                    // Use fallback data
                    players = [
                        { player_name: 'bigtanker13', team_code: 'CRAKD', battles_played: '100%', total_points: 5714.7, average_points: 53.9, picked_percentage: '50.04%' },
                        { player_name: 'Ferret', team_code: 'DOPA', battles_played: '99%', total_points: 5550.5, average_points: 48.7, picked_percentage: '57.61%' },
                        { player_name: 'Poi', team_code: 'ARCANE', battles_played: '100%', total_points: 5298.5, average_points: 49.5, picked_percentage: '55.14%' },
                        { player_name: 'Sadge', team_code: 'MVP', battles_played: '91%', total_points: 4868.7, average_points: 46.4, picked_percentage: '11.85%' },
                        { player_name: 'pringle', team_code: 'DONER', battles_played: '97%', total_points: 4781.3, average_points: 45.8, picked_percentage: '29.86%' },
                        { player_name: 'will', team_code: 'EMPLOY', battles_played: '90%', total_points: 4567.0, average_points: 43.9, picked_percentage: '17.93%' },
                        { player_name: 'Charan', team_code: 'CINE', battles_played: '80%', total_points: 4513.9, average_points: 49.1, picked_percentage: '10.58%' },
                        { player_name: 'Stored', team_code: 'FUMES', battles_played: '79%', total_points: 4492.0, average_points: 52.8, picked_percentage: '7.50%' }
                    ];
                }
                
                // Update players table
                populatePlayersTable();
                populateTeamFilter();
                
                return players;
            } catch (error) {
                console.error('❌ Error loading players:', error);
                showErrorInPlayersTab('Failed to load player data. Please try refreshing the page.');
                return [];
            }
        }

        // Load teams from API
        async function loadTeams() {
            try {
                const response = await api.getTeams(tournamentId);
                teams = response.teams || [];
                return teams;
            } catch (error) {
                console.error('❌ Error loading teams:', error);
                showErrorInTeamsTab('Failed to load team data. Please try refreshing the page.');
                return [];
            }
        }

        // Load leaderboard from API
        async function loadLeaderboard() {
            try {
                const response = await api.getLeaderboard(tournamentId);
                leaderboard = response.leaderboard || [];
                
                if (leaderboard.length === 0) {
                    console.warn('⚠️ No leaderboard data found from API, using fallback data');
                    // Use fallback data
                    leaderboard = [
                        { username: 'pringle', total_points: 2847, rank: 1 },
                        { username: 'Charan', total_points: 2739, rank: 2 },
                        { username: 'Stored', total_points: 2681, rank: 3 },
                        { username: 'will', total_points: 2594, rank: 4 },
                        { username: 'Poi', total_points: 2512, rank: 5 }
                    ];
                }
                
                // Update leaderboard displays
                populateTopTeams();
                populateStandings();
                
                return leaderboard;
            } catch (error) {
                console.error('❌ Error loading leaderboard:', error);
                showErrorInStandingsTab('Failed to load leaderboard data. Please try refreshing the page.');
                return [];
            }
        }

        // Load user's roster from API
        async function loadUserRoster() {
            if (!api.isAuthenticated()) return;
            
            try {
                console.log('📋 Loading user roster...');
                const response = await api.getRoster(tournamentId);
                currentRoster = response.roster || [];
                console.log('✅ User roster loaded:', currentRoster);
                updateRosterDisplay();
            } catch (error) {
                console.error('❌ Error loading user roster:', error);
                // Don't show error for missing roster, just use empty roster
                currentRoster = [];
                updateRosterDisplay();
            }
        }

        // Save user's roster to API
        async function saveUserRoster() {
            if (!api.isAuthenticated()) {
                console.log('👤 User not authenticated, skipping roster save');
                return;
            }
            
            try {
                console.log('💾 Saving user roster...', currentRoster);
                await api.saveRoster(tournamentId, currentRoster);
                console.log('✅ User roster saved successfully');
            } catch (error) {
                console.error('❌ Error saving user roster:', error);
                showNotification('Failed to save roster. Please try again.', 'error');
            }
        }

        // Update tournament statistics
        function updateTournamentStats() {
            // Update total players count
            const totalPlayersElements = document.querySelectorAll('#totalPlayers');
            totalPlayersElements.forEach(el => {
                el.textContent = players.length || '144';
            });
            
            // Update fantasy team count
            const fantasyTeamCount = leaderboard.length || 93;
            const fantasyElements = document.querySelectorAll('#fantasyTeamCount, #fantasyTeamCountLarge, #totalFantasyTeams');
            fantasyElements.forEach(el => {
                el.textContent = `${fantasyTeamCount} Fantasy Teams`;
            });
            
            // Update roster status
            const rosterStatusEl = document.getElementById('rosterStatus');
            if (rosterStatusEl) {
                if (rostersUnlocked) {
                    rosterStatusEl.textContent = 'Rosters Open';
                    rosterStatusEl.classList.remove('locked');
                } else {
                    rosterStatusEl.textContent = 'Rosters Locked';
                    rosterStatusEl.classList.add('locked');
                }
            }
        }

        // Populate players table
        function populatePlayersTable() {
            const playersContainer = document.getElementById('playersContainer');
            if (!playersContainer) return;
            
            if (players.length === 0) {
                playersContainer.innerHTML = `
                    <div class="error-state">
                        <span class="material-icons error-icon">error</span>
                        <h3>No Player Data Available</h3>
                        <p>Player data is currently being loaded. Please check back soon.</p>
                        <button class="retry-btn" onclick="loadPlayers()">Retry Loading</button>
                    </div>
                `;
                return;
            }
            
            // Filter players by team if selected
            const teamFilter = document.getElementById('teamFilter');
            const selectedTeam = teamFilter ? teamFilter.value : '';
            const filteredPlayers = selectedTeam ? 
                players.filter(p => p.team_code === selectedTeam) : 
                players;
            
            playersContainer.innerHTML = `
                <div class="players-table-container">
                    <table class="players-table">
                        <thead>
                            <tr>
                                <th class="action-column">Action</th>
                                <th class="sortable" data-sort="player_name">
                                    Name
                                    <span class="material-icons sort-icon">expand_more</span>
                                </th>
                                <th class="sortable" data-sort="team_code">
                                    Team
                                </th>
                                <th class="sortable" data-sort="battles_played">
                                    Battles
                                </th>
                                <th class="sortable" data-sort="total_points">
                                    Points
                                    <span class="material-icons sort-icon">expand_more</span>
                                </th>
                                <th class="sortable" data-sort="average_points">
                                    Avg. Points
                                </th>
                                <th class="sortable" data-sort="picked_percentage">
                                    Picked By
                                </th>
                            </tr>
                        </thead>
                        <tbody>
                            ${filteredPlayers.map(player => {
                                // Determine action button state
                                let actionIcon = 'lock';
                                let actionClass = '';
                                let actionTitle = 'Sign in to manage roster';
                                
                                if (api.isAuthenticated()) {
                                    if (rostersUnlocked) {
                                        if (currentRoster.includes(player.player_name)) {
                                            actionIcon = 'remove';
                                            actionClass = 'remove';
                                            actionTitle = 'Remove from roster';
                                        } else if (currentRoster.length < maxRosterSize) {
                                            actionIcon = 'add';
                                            actionClass = 'add';
                                            actionTitle = 'Add to roster';
                                        } else {
                                            actionIcon = 'lock';
                                            actionClass = '';
                                            actionTitle = 'Roster is full';
                                        }
                                    } else {
                                        actionIcon = 'lock';
                                        actionClass = '';
                                        actionTitle = 'Rosters are locked';
                                    }
                                }

                                return `
                                    <tr>
                                        <td class="action-column">
                                            <button class="player-action-btn ${actionClass}" 
                                                    data-player="${player.player_name}" 
                                                    title="${actionTitle}">
                                                <span class="material-icons">${actionIcon}</span>
                                            </button>
                                        </td>
                                        <td class="player-name">${player.player_name}</td>
                                        <td class="player-team">${player.team_code}</td>
                                        <td class="player-battles">${player.battles_played || '0%'}</td>
                                        <td class="player-points">${parseFloat(player.total_points || 0).toLocaleString()}</td>
                                        <td class="player-avg">${player.average_points || '0.0'}</td>
                                        <td class="player-picked">${player.picked_percentage || '0%'}</td>
                                    </tr>
                                `;
                            }).join('')}
                        </tbody>
                    </table>
                </div>
            `;

            // Add event listeners to action buttons
            document.querySelectorAll('.player-action-btn').forEach(btn => {
                btn.addEventListener('click', handlePlayerAction);
            });
            
            // Add sorting functionality
            document.querySelectorAll('.sortable').forEach(th => {
                th.addEventListener('click', () => {
                    const column = th.dataset.sort;
                    const currentDirection = th.classList.contains('asc') ? 'desc' : 'asc';
                    
                    document.querySelectorAll('.sortable').forEach(header => {
                        header.classList.remove('asc', 'desc');
                    });
                    
                    th.classList.add(currentDirection);
                    sortPlayers(column, currentDirection);
                });
            });
        }

        // Populate team filter dropdown
        function populateTeamFilter() {
            const teamFilter = document.getElementById('teamFilter');
            if (!teamFilter) return;
            
            // Get unique teams from players
            const uniqueTeams = [...new Set(players.map(p => p.team_code))].sort();
            
            // Keep the "All Teams" option and add unique teams
            teamFilter.innerHTML = `
                <option value="">All Teams</option>
                ${uniqueTeams.map(team => `<option value="${team}">${team}</option>`).join('')}
            `;
            
            // Add change event listener
            teamFilter.addEventListener('change', populatePlayersTable);
        }

        // Sort players
        function sortPlayers(column, direction) {
            players.sort((a, b) => {
                let aVal = a[column];
                let bVal = b[column];
                
                if (column === 'total_points' || column === 'average_points') {
                    aVal = parseFloat(aVal) || 0;
                    bVal = parseFloat(bVal) || 0;
                } else if (column === 'picked_percentage' || column === 'battles_played') {
                    aVal = parseFloat((aVal || '0%').replace('%', ''));
                    bVal = parseFloat((bVal || '0%').replace('%', ''));
                }
                
                if (direction === 'asc') {
                    return aVal > bVal ? 1 : -1;
                } else {
                    return aVal < bVal ? 1 : -1;
                }
            });
            
            populatePlayersTable();
        }

        // Handle player roster actions
        function handlePlayerAction(e) {
            const playerName = e.currentTarget.dataset.player;
            const button = e.currentTarget;
            
            if (!api.isAuthenticated()) {
                showNotification('Please sign in to manage your roster', 'error');
                setTimeout(() => redirectToLogin(), 1500);
                return;
            }
            
            if (!rostersUnlocked) {
                showNotification('Rosters are currently locked for this tournament', 'error');
                return;
            }
            
            if (button.classList.contains('add')) {
                addPlayerToRoster(playerName);
            } else if (button.classList.contains('remove')) {
                removePlayerFromRoster(playerName);
            }
        }

        // Add player to roster
        function addPlayerToRoster(playerName) {
            if (currentRoster.length >= maxRosterSize) {
                showNotification(`Roster is full (${maxRosterSize} players maximum)`, 'error');
                return;
            }
            
            if (currentRoster.includes(playerName)) {
                showNotification('Player is already in your roster', 'error');
                return;
            }
            
            currentRoster.push(playerName);
            updateRosterDisplay();
            populatePlayersTable();
            saveUserRoster();
            
            showNotification(`${playerName} added to roster`, 'success');
        }

        // Remove player from roster
        function removePlayerFromRoster(playerName) {
            const index = currentRoster.indexOf(playerName);
            if (index > -1) {
                currentRoster.splice(index, 1);
                updateRosterDisplay();
                populatePlayersTable();
                saveUserRoster();
                
                showNotification(`${playerName} removed from roster`, 'success');
            }
        }

        // Update roster display
        function updateRosterDisplay() {
            const rosterCount = document.getElementById('rosterCount');
            const rosterList = document.getElementById('rosterList');
            const rosterMessage = document.getElementById('rosterMessage');
            
            if (!rosterCount) return;
            
            rosterCount.textContent = currentRoster.length;
            
            if (currentRoster.length > 0) {
                if (rosterMessage) rosterMessage.style.display = 'none';
                if (rosterList) {
                    rosterList.style.display = 'block';
                    rosterList.innerHTML = currentRoster.map(playerName => `
                        <div class="roster-player">
                            <span class="roster-player-name">${playerName}</span>
                            <button class="roster-player-remove" 
                                    onclick="removePlayerFromRoster('${playerName}')"
                                    title="Remove player">
                                <span class="material-icons" style="font-size: 1rem;">close</span>
                            </button>
                        </div>
                    `).join('');
                }
            } else {
                if (rosterMessage) {
                    rosterMessage.style.display = 'block';
                    updateRosterMessage();
                }
                if (rosterList) rosterList.style.display = 'none';
            }
        }

        // Update roster message based on auth status
        function updateRosterMessage() {
            const rosterMessage = document.getElementById('rosterMessage');
            if (!rosterMessage) return;
            
            if (!api.isAuthenticated()) {
                rosterMessage.innerHTML = `
                    <strong>Sign in to build your fantasy roster!</strong>
                    <br><br>
                    Create an account or sign in to draft players and compete against other fantasy teams.
                    <br><br>
                    <button class="action-btn" onclick="redirectToLogin()" style="margin-top: 1rem;">
                        <span class="material-icons">login</span>
                        Sign In
                    </button>
                `;
            } else if (!rostersUnlocked) {
                rosterMessage.innerHTML = `
                    Rosters are currently locked for this tournament.
                    <br><br>
                    Tournament administrators may be configuring the site or the tournament may be in progress.
                `;
            } else {
                rosterMessage.innerHTML = 'Your roster is empty. Add players from the table above to build your fantasy team.';
            }
        }

        // Update roster status for authenticated users
        function updateRosterStatusForAuth() {
            // This could be expanded to show more detailed roster status
        }

        // Update roster message for guest users
        function updateRosterMessageForGuests() {
            updateRosterMessage();
        }

        // Populate top teams in sidebar
        function populateTopTeams() {
            const topTeamsContainer = document.getElementById('topTeamsContainer');
            if (!topTeamsContainer) return;
            
            if (leaderboard.length === 0) {
                topTeamsContainer.innerHTML = `
                    <div style="text-align: center; padding: 2rem; color: rgba(255, 255, 255, 0.6);">
                        <p>No leaderboard data available yet.</p>
                    </div>
                `;
                return;
            }
            
            const topTeams = leaderboard.slice(0, 5);
            topTeamsContainer.innerHTML = `
                <ul class="teams-list">
                    ${topTeams.map(team => `
                        <li class="team-item">
                            <div class="team-info">
                                <span class="team-rank">${team.rank}</span>
                                <span class="team-name">${team.username}</span>
                            </div>
                            <span class="team-score">${team.total_points.toLocaleString()}</span>
                        </li>
                    `).join('')}
                </ul>
            `;
        }

        // Populate standings tab
        function populateStandings() {
            const standingsContainer = document.getElementById('standingsContainer');
            if (!standingsContainer) return;
            
            if (leaderboard.length === 0) {
                standingsContainer.innerHTML = `
                    <div style="text-align: center; padding: 4rem 2rem; color: rgba(255, 255, 255, 0.6);">
                        <span class="material-icons" style="font-size: 4rem; margin-bottom: 1rem; opacity: 0.4;">leaderboard</span>
                        <h3 style="margin-bottom: 1rem;">No Fantasy Teams Yet</h3>
                        <p>Fantasy team rankings will appear here once teams start building rosters.</p>
                    </div>
                `;
                return;
            }
            
            standingsContainer.innerHTML = `
                <div class="standings-table-container" style="background: rgba(255, 255, 255, 0.05); border: 1px solid rgba(255, 255, 255, 0.1); border-radius: 16px; overflow: hidden; backdrop-filter: blur(10px);">
                    <table style="width: 100%; border-collapse: collapse;">
                        <thead>
                            <tr style="background: rgba(255, 255, 255, 0.08);">
                                <th style="padding: 1rem; text-align: left; color: rgba(255, 255, 255, 0.9); font-weight: 600; font-size: 0.9rem; text-transform: uppercase; letter-spacing: 0.5px; border-bottom: 1px solid rgba(255, 255, 255, 0.1);">Rank</th>
                                <th style="padding: 1rem; text-align: left; color: rgba(255, 255, 255, 0.9); font-weight: 600; font-size: 0.9rem; text-transform: uppercase; letter-spacing: 0.5px; border-bottom: 1px solid rgba(255, 255, 255, 0.1);">Team Name</th>
                                <th style="padding: 1rem; text-align: right; color: rgba(255, 255, 255, 0.9); font-weight: 600; font-size: 0.9rem; text-transform: uppercase; letter-spacing: 0.5px; border-bottom: 1px solid rgba(255, 255, 255, 0.1);">Total Points</th>
                            </tr>
                        </thead>
                        <tbody>
                            ${leaderboard.map((team, index) => `
                                <tr style="border-bottom: 1px solid rgba(255, 255, 255, 0.05); ${api.isAuthenticated() && api.getCurrentUser()?.username === team.username ? 'background: rgba(0, 212, 255, 0.1);' : ''}">
                                    <td style="padding: 1rem; color: #00d4ff; font-weight: 700;">${team.rank}</td>
                                    <td style="padding: 1rem; color: rgba(255, 255, 255, 0.9); font-weight: 600;">${team.username}</td>
                                    <td style="padding: 1rem; text-align: right; color: #00d4ff; font-weight: 600;">${team.total_points.toLocaleString()}</td>
                                </tr>
                            `).join('')}
                        </tbody>
                    </table>
                </div>
            `;
        }

        // Show error in players tab
        function showErrorInPlayersTab(message) {
            const playersContainer = document.getElementById('playersContainer');
            if (playersContainer) {
                playersContainer.innerHTML = `
                    <div class="error-state">
                        <span class="material-icons error-icon">error</span>
                        <h3>Failed to Load Players</h3>
                        <p>${message}</p>
                        <button class="retry-btn" onclick="loadPlayers()">Retry</button>
                    </div>
                `;
            }
        }

        // Show error in teams tab
        function showErrorInTeamsTab(message) {
            const teamsContainer = document.getElementById('teamsContainer');
            if (teamsContainer) {
                teamsContainer.innerHTML = `
                    <div class="error-state">
                        <span class="material-icons error-icon">error</span>
                        <h3>Failed to Load Teams</h3>
                        <p>${message}</p>
                        <button class="retry-btn" onclick="loadTeams()">Retry</button>
                    </div>
                `;
            }
        }

        // Show error in standings tab
        function showErrorInStandingsTab(message) {
            const standingsContainer = document.getElementById('standingsContainer');
            if (standingsContainer) {
                standingsContainer.innerHTML = `
                    <div class="error-state">
                        <span class="material-icons error-icon">error</span>
                        <h3>Failed to Load Standings</h3>
                        <p>${message}</p>
                        <button class="retry-btn" onclick="loadLeaderboard()">Retry</button>
                    </div>
                `;
            }
        }

        // Show notification messages
        function showNotification(message, type) {
            const notification = document.createElement('div');
            notification.innerHTML = `
                <span class="material-icons">${type === 'success' ? 'check_circle' : 'error'}</span>
                <span>${message}</span>
                <button onclick="this.parentElement.remove()">
                    <span class="material-icons">close</span>
                </button>
            `;
            
            notification.style.cssText = `
                position: fixed;
                top: 2rem;
                right: 2rem;
                background: ${type === 'success' ? 'rgba(34, 197, 94, 0.9)' : 'rgba(239, 68, 68, 0.9)'};
                color: white;
                padding: 1rem;
                border-radius: 8px;
                display: flex;
                align-items: center;
                gap: 0.5rem;
                z-index: 10000;
                box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
                backdrop-filter: blur(10px);
                animation: slideInRight 0.3s ease;
            `;
            
            document.body.appendChild(notification);
            setTimeout(() => notification.remove(), 4000);
        }

        // Auth functions
        function redirectToLogin() {
            window.location.href = 'login.html?return=' + encodeURIComponent(window.location.href);
        }

        function handleLogout() {
            api.logout();
        }

        function toggleUserDropdown() {
            const dropdown = document.getElementById('userDropdown');
            dropdown.classList.toggle('show');
        }

        // Navigation functions
        function goToPlayersTab() {
            const playersTab = document.querySelector('[data-tab="players"]');
            if (playersTab) {
                playersTab.click();
            }
        }

        function goToStandingsTab() {
            const standingsTab = document.querySelector('[data-tab="standings"]');
            if (standingsTab) {
                standingsTab.click();
            }
        }

        // Tab navigation
        document.querySelectorAll('.nav-tab').forEach(tab => {
            tab.addEventListener('click', (e) => {
                e.preventDefault();
                
                document.querySelectorAll('.nav-tab').forEach(t => t.classList.remove('active'));
                document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
                
                tab.classList.add('active');
                
                const targetTab = tab.dataset.tab;
                const targetContent = document.getElementById(targetTab);
                if (targetContent) {
                    targetContent.classList.add('active');
                }
            });
        });

        // Close dropdown when clicking outside
        document.addEventListener('click', function(e) {
            const userMenu = document.getElementById('userMenu');
            const dropdown = document.getElementById('userDropdown');
            
            if (userMenu && !userMenu.contains(e.target)) {
                dropdown.classList.remove('show');
            }
        });

        // Initialize page when DOM is loaded
        document.addEventListener('DOMContentLoaded', () => {
            console.log('🎯 DOM loaded, initializing tournament page...');
            initializePage();
        });

        // Add styles for animations
        const style = document.createElement('style');
        style.textContent = `
            @keyframes slideInRight {
                from { transform: translateX(100%); opacity: 0; }
                to { transform: translateX(0); opacity: 1; }
            }
        `;
        document.head.appendChild(style);
    </script>
</body>
</html>